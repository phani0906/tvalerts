<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Stocks Scanner</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="scanner.css?v=5" />
    <script src="/socket.io/socket.io.js"></script>
  </head>

  <body>
    <!-- Top scrolling quote -->
    <div id="quote-bar"><span id="quote-text">Loading quote...</span></div>
    <button id="pivotToggleBtn" class="pivot-toggle-btn">Pivot: Vertical</button>

    <!-- ===== Pivot/CPR (four tables) ===== -->
    <div class="pivot-grid" id="pivotGrid">
      <!-- 1) Bullish Continuation -->
      <div class="table-container buy-table">
        <h3 class="table-title buy-title">üìà Bullish Continuation</h3>
        <table id="pivotTableBullCont">
          <thead>
            <tr>
              <th>Ticker</th>
              <th>Pivot Rel.</th>
              <th>Open/Price</th>
              <th>Mid-point</th>
              <th>PDH</th>
              <th>Daily MA20</th>
              <th>Pivot Levels</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <!-- 2) Bearish Continuation -->
      <div class="table-container sell-table">
        <h3 class="table-title sell-title">üìâ Bearish Continuation</h3>
        <table id="pivotTableBearCont">
          <thead>
            <tr>
              <th>Ticker</th>
              <th>Pivot Rel.</th>
              <th>Open/Price</th>
              <th>Mid-point</th>
              <th>PDH</th>
              <th>Daily MA20</th>
              <th>Pivot Levels</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <!-- 3) Bullish Trend Reversal -->
      <div class="table-container buy-table">
        <h3 class="table-title buy-title">üîÅ Bullish Trend Reversal</h3>
        <table id="pivotTableBullRev">
          <thead>
            <tr>
              <th>Ticker</th>
              <th>Pivot Rel.</th>
              <th>Open/Price</th>
              <th>Mid-point</th>
              <th>PDH</th>
              <th>Daily MA20</th>
              <th>Pivot Levels</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <!-- 4) Bearish Trend Reversal -->
      <div class="table-container sell-table">
        <h3 class="table-title sell-title">üîÅ Bearish Trend Reversal</h3>
        <table id="pivotTableBearRev">
          <thead>
            <tr>
              <th>Ticker</th>
              <th>Pivot Rel.</th>
              <th>Open/Price</th>
              <th>Mid-point</th>
              <th>PDH</th>
              <th>Daily MA20</th>
              <th>Pivot Levels</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
    <!-- ===== /Pivot/CPR ===== -->

    <!-- GREEN ZONE (5m) -->
    <div class="table-container buy-table">
      <h3 class="table-title buy-title">üî• Green Zone (5mins)</h3>
      <table id="scannerTableBuy">
        <thead>
          <tr>
            <th>Time</th>
            <th>Ticker</th>
            <th>Alert</th>
            <th>Price</th>
            <th>MA20 (5m)</th>
            <th>VWAP (5m)</th>
            <th>DayMid</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- RED ZONE (5m) -->
    <div class="table-container sell-table">
      <h3 class="table-title sell-title">‚ö° Red Zone (5mins)</h3>
      <table id="scannerTableSell">
        <thead>
          <tr>
            <th>Time</th>
            <th>Ticker</th>
            <th>Alert</th>
            <th>Price</th>
            <th>MA20 (5m)</th>
            <th>VWAP (5m)</th>
            <th>DayMid</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- GREEN ZONE (15m) -->
    <div class="table-container buy-table">
      <h3 class="table-title buy-title">üî• Green Zone ‚Äî 15m</h3>
      <table id="scannerTableBuy15">
        <thead>
          <tr>
            <th>Time</th>
            <th>Ticker</th>
            <th>Alert</th>
            <th>Price</th>
            <th>MA20 (15m)</th>
            <th>VWAP (15m)</th>
            <th>DayMid</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- RED ZONE (15m) -->
    <div class="table-container sell-table">
      <h3 class="table-title sell-title">‚ö° Red Zone ‚Äî 15m</h3>
      <table id="scannerTableSell15">
        <thead>
          <tr>
            <th>Time</th>
            <th>Ticker</th>
            <th>Alert</th>
            <th>Price</th>
            <th>MA20 (15m)</th>
            <th>VWAP (15m)</th>
            <th>DayMid</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- GREEN ZONE (1h) -->
    <div class="table-container buy-table">
      <h3 class="table-title buy-title">üî• Green Zone ‚Äî 1h</h3>
      <table id="scannerTableBuy1h">
        <thead>
          <tr>
            <th>Time</th>
            <th>Ticker</th>
            <th>Alert</th>
            <th>Price</th>
            <th>MA20 (1h)</th>
            <th>VWAP (1h)</th>
            <th>DayMid</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- RED ZONE (1h) -->
    <div class="table-container sell-table">
      <h3 class="table-title sell-title">‚ö° Red Zone ‚Äî 1h</h3>
      <table id="scannerTableSell1h">
        <thead>
          <tr>
            <th>Time</th>
            <th>Ticker</th>
            <th>Alert</th>
            <th>Price</th>
            <th>MA20 (1h)</th>
            <th>VWAP (1h)</th>
            <th>DayMid</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- Scripts -->
    <script src="pivotPanel.js?v=5" defer></script>
    <script src="scanner.js?v=13" defer></script>

    <!-- Pivot layout toggle (stack grid into one column; keep table rows intact) -->
    <script>
      (() => {
        const ORDER = ['pivotTableBullCont','pivotTableBearCont','pivotTableBullRev','pivotTableBearRev'];
        const btn   = document.getElementById('pivotToggleBtn');
        const grid  = document.getElementById('pivotGrid');

        // Ensure any old card/vertical classes are cleared (from earlier experiments)
        function scrubOldVertical() {
          ORDER.forEach(id => document.getElementById(id)?.classList.remove('vertical-table'));
          grid?.classList.remove('pivot-vertical-container'); // legacy wrapper class
        }

        // Keep the four tables in the fixed order
        function reorderFixed() {
          if (!grid) return;
          for (const id of ORDER) {
            const tbl = document.getElementById(id);
            if (!tbl) continue;
            const container = tbl.closest('.table-container') || tbl.parentElement;
            if (container) grid.appendChild(container);
          }
        }

        function setStacked(on) {
          if (!grid) return;
          grid.classList.toggle('stacked', on);     // <-- only the grid changes
          btn.textContent = on ? 'Pivot: Grid' : 'Pivot: Vertical';
        }

        // Init: horizontal grid (2 cols), fixed order
        scrubOldVertical();
        reorderFixed();
        setStacked(false);

        let stacked = false;
        btn.addEventListener('click', () => {
          stacked = !stacked;
          setStacked(stacked);
        });
      })();
    </script>
  </body>
</html>
